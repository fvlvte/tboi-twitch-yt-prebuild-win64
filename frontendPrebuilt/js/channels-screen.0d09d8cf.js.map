{"version":3,"sources":["webpack:///./src/components/InputField.vue?08a9","webpack:///./src/libs/streamEvents.js","webpack:///./src/screens/Channels.vue?db20","webpack:///./src/screens/Channels.vue","webpack:///./src/components/InputField.vue","webpack:///src/components/InputField.vue","webpack:///./src/components/InputField.vue?c147","webpack:///./src/components/InputField.vue?ba49","webpack:///src/screens/Channels.vue","webpack:///./src/screens/Channels.vue?e96a","webpack:///./src/screens/Channels.vue?9ffd","webpack:///./src/libs/youtubeConnect.js","webpack:///./src/libs/twitchConnect.js"],"names":["TextMessage","constructor","userId","userName","text","source","this","trim","DonateMessage","amount","type","Subscriber","Follower","render","_vm","_c","_self","staticClass","_v","_s","_f","$store","state","locale","ref","attrs","model","value","twitchChannel","callback","$$v","expression","youtubeUrl","on","connect","staticRenderFns","placeholder","domProps","val","$event","$emit","target","name","props","methods","getImgUrl","component","components","InputField","BigButton","data","computed","local","mounted","YoutubeConnect","streamURLString","apikey","split","reverse","join","streamURL","URL","lastMessagesId","vuewersCount","channel","nextPageToken","consoleStyle","hostname","streamId","searchParams","get","pathname","substr","events","onMessage","onSub","onFollower","onSuperchat","onConnect","onDisconnect","onError","fetch","then","res","json","_updateChat","updTimer","setInterval","bind","catch","err","_signal","disconnect","clearInterval","updateViewers","items","forEach","msg","isSponsor","channelId","authorName","_log","authorDetails","displayName","msgContent","console","log","TwitchConnect","viewersCount","botname","server","lastFollowers","plannedDisconnect","onBits","window","location","protocol","includes","webSocket","WebSocket","onmessage","onerror","onclose","onClose","onopen","onOpen","startCheckNewFollowers","checkFollowersFrom","Date","now","waitUserId","_checkFollowers","updFollowersTimer","stopCheckNewFollowers","headers","stream","viewers","parsed","_parseMessage","command","tags","hasOwnProperty","bits","parseFloat","bitsType","bitsCount","Math","round","message","send","readyState","toLowerCase","close","follower","from_id","splice","push","followed_at","from_name","rawMessage","parsedMessage","original","username","tagIndex","indexOf","userIndex","commandIndex","channelIndex","messageIndex","slice","keyedTags","splitted","startsWith"],"mappings":"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","file":"js/channels-screen.0d09d8cf.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputField.vue?vue&type=style&index=0&id=4b09c508&prod&lang=scss&\"","/**\n * Basic text message from Twitch or Youtube chat\n */\nexport class TextMessage {\n\n  /**\n   *\n   * @param {Number|String} userId - Unique user id\n   * @param {String} userName - Displayed user name\n   * @param {String} text - Message text\n   * @param {String} source - Source of message, \"yt\" for YouTube, \"tw\" fro Twitch\n   */\n  constructor(userId, userName, text, source) {\n    this.userId = userId;\n    this.userName = userName;\n    this.text = text.trim();\n    this.source = source;\n  }\n\n}\n\n/**\n * Bits message for Twitch\n * Superchat message for Youtube\n */\nexport class DonateMessage {\n\n  /**\n   *\n   * @param {Number|String} userId - Unique user id\n   * @param {String} userName - Displayed user name\n   * @param {Number} amount - Amount of bits\n   * @param {Number} type - Type of bits\n   * @param {String} source - Source of message, \"yt\" for YouTube, \"tw\" fro Twitch\n   */\n  constructor (userId, userName, amount, type, source) {\n    this.userId = userId;\n    this.userName = userName;\n    this.amount = amount;\n    this.type = type;\n    this.source = source;\n  }\n}\n\n/**\n * New subscriber on Twitch\n * New sponsor on YouTube\n */\nexport class Subscriber {\n\n  /**\n   *\n   * @param {Number|String} userId - Unique user id\n   * @param {String} userName - Displayed user name\n   * @param {String} source - Source of message, \"yt\" for YouTube, \"tw\" fro Twitch\n   */\n  constructor (userId, userName, source) {\n    this.userId = userId;\n    this.userName = userName;\n    this.source = source;\n  }\n}\n\n/**\n * New followers\n * Currently not using\n */\nexport class Follower {\n  constructor (userId, userName, source) {\n    this.userId = userId;\n    this.userName = userName;\n    this.source = source;\n  }\n}","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Channels.vue?vue&type=style&index=0&id=55b139ca&prod&lang=scss&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"channelScreen\"},[_c('h1',[_vm._v(_vm._s(_vm._f(\"t\")(\"whoAreYou\",_vm.$store.state.locale)))]),_c('div',{staticClass:\"channels-description\"},[_vm._v(_vm._s(_vm._f(\"t\")(\"channelsDesc\",_vm.$store.state.locale)))]),_c('div',{staticClass:\"fields\"},[_c('div',{staticClass:\"field\"},[_c('div',{staticClass:\"sign twitch\"},[_vm._v(\"Twitch\")]),_c('InputField',{ref:\"twitchChannel\",attrs:{\"placeholder\":_vm._f(\"t\")('channelName',_vm.$store.state.locale)},model:{value:(_vm.twitchChannel),callback:function ($$v) {_vm.twitchChannel=$$v},expression:\"twitchChannel\"}})],1),_c('div',{staticClass:\"field\"},[_c('div',{staticClass:\"sign youtube\"},[_vm._v(\"YouTube\")]),_c('InputField',{attrs:{\"placeholder\":_vm._f(\"t\")('streamURL',_vm.$store.state.locale)},model:{value:(_vm.youtubeUrl),callback:function ($$v) {_vm.youtubeUrl=$$v},expression:\"youtubeUrl\"}})],1)]),_c('div',[_c('BigButton',{on:{\"onClick\":_vm.connect}},[_vm._v(_vm._s(_vm._f(\"t\")(\"play\",_vm.$store.state.locale))+\" >\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"inputField\"},[_c('input',{ref:\"inputField\",attrs:{\"type\":\"text\",\"placeholder\":_vm.placeholder},domProps:{\"value\":_vm.val},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}})])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"inputField\">\n    <input ref=\"inputField\" v-bind:value=\"val\" v-on:input=\"$emit('input', $event.target.value)\" type=\"text\" :placeholder=\"placeholder\"/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"InputField\",\n\n  props: {\n    placeholder: String,\n    val: String\n  },\n\n  methods: {\n    getImgUrl(img) {\n      var images = require.context('../assets/img/', false, /\\.png$/)\n      return images('./' + img + \".png\")\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.inputField {\n  background-image: url(\"../assets/img/inputBg.png\");\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: left;\n\n  height: 100px;\n  padding: 5px;\n\n  display: flex;\n  justify-content: left;\n  align-items: center;\n  padding-left: 25px;\n\n  input {\n    max-width: 500px;\n    width: 95%;\n    outline: none;\n    border: none;\n    background: none;\n    font: 1.5rem TeamMeat;\n    border-bottom: 3px solid #333;\n    margin-bottom: 3.8%;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputField.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputField.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InputField.vue?vue&type=template&id=4b09c508&\"\nimport script from \"./InputField.vue?vue&type=script&lang=js&\"\nexport * from \"./InputField.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InputField.vue?vue&type=style&index=0&id=4b09c508&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"channelScreen\">\n    <h1>{{\"whoAreYou\" | t($store.state.locale)}}</h1>\n    <div class=\"channels-description\">{{\"channelsDesc\" | t($store.state.locale)}}</div>\n    <div class=\"fields\">\n      <div class=\"field\">\n        <div class=\"sign twitch\">Twitch</div>\n        <InputField v-model=\"twitchChannel\" ref=\"twitchChannel\" :placeholder=\"'channelName' | t($store.state.locale)\"/>\n      </div>\n      <div class=\"field\">\n        <div class=\"sign youtube\">YouTube</div>\n        <InputField v-model=\"youtubeUrl\" :placeholder=\"'streamURL' | t($store.state.locale)\"/>\n      </div>\n    </div>\n    <div>\n      <BigButton @onClick=\"connect\">{{\"play\" | t($store.state.locale)}} ></BigButton>\n    </div>\n  </div>\n</template>\n\n<script>\nimport InputField from '../components/InputField.vue';\nimport BigButton from '../components/BigButton.vue';\n\nimport TwitchConnect from '../libs/twitchConnect.js';\nimport YoutubeConnect from '../libs/youtubeConnect.js'\n\nexport default {\n  name: 'channelScreen',\n  components: {\n    InputField, BigButton\n  },\n\n  data () {\n    return {\n      twitchChannel: \"\",\n      youtubeUrl: \"\"\n    }\n  },\n\n  computed: {\n    local () {\n      return this.$root.local;\n    }\n  },\n\n  methods: {\n\n    connect () {\n\n      if (this.twitchChannel == '' && this.youtubeUrl == '') return;\n\n      if (this.twitchChannel != '') {\n        this.$services.twitch = new TwitchConnect(this.twitchChannel);\n        this.$services.twitch.connect();\n        this.$store.commit('setTwitchName', this.twitchChannel);\n        //this.$services.twitch.startCheckNewFollowers();\n      }\n\n      if (this.youtubeUrl != '') {\n        this.$services.youtube = new YoutubeConnect(this.youtubeUrl);\n        this.$services.youtube.connect();\n      }\n\n      this.$router.push('/settings');\n    }\n  },\n\n  mounted () {\n    this.$refs.twitchChannel.$refs.inputField.value = this.$store.state.twitchName;\n    this.twitchChannel = this.$store.state.twitchName;\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n.channels-description {\n  font-size: 16px;\n  margin-top: -12px;\n  margin-bottom: 20px;\n}\n\n.fields {\n  display: inline-block;\n  margin: 0 auto;\n\n  .sign {\n    font-size: 1.8rem;\n    margin-right: 15px;\n  }\n\n  .field {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    flex-wrap: wrap;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Channels.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Channels.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Channels.vue?vue&type=template&id=55b139ca&\"\nimport script from \"./Channels.vue?vue&type=script&lang=js&\"\nexport * from \"./Channels.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Channels.vue?vue&type=style&index=0&id=55b139ca&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {TextMessage, DonateMessage, Subscriber} from './streamEvents';\n\nexport default class YoutubeConnect {\n\n  /**\n   * Create new chat object for Youtube\n   * @param {String} streamURLString - URL for YouTube stream\n   */\n  constructor (streamURLString) {\n    this.apikey = \"wgnn-wBx-_VT5Nu996o8ylc-t786swbRBySazIA\".split('').reverse().join('');\n    this.streamURL = new URL(streamURLString);\n    this.lastMessagesId = [];\n    this.vuewersCount = 0;\n    this.channel = null;\n    this.nextPageToken = null;\n\n    this.consoleStyle = 'background-color: #FF0000; color: #FFFFFF; border-radius: 100px;padding: 1px 4px;';\n\n    if (this.streamURL.hostname == \"www.youtube.com\" || this.streamURL.hostname == \"youtube.com\") {\n      this.streamId = this.streamURL.searchParams.get('v');\n    }\n    else {\n      this.streamId = this.streamURL.pathname.substr(1);\n    }\n\n    this.events = {\n      onMessage: () => {},\n      onSub: () => {},\n      onFollower: () => {},\n      onSuperchat: () => {},\n\n      onConnect: () => {},\n      onDisconnect: () => {},\n      onError:  () => {}\n    }\n  }\n\n  connect () {\n    fetch(\n      \"http://localhost:22137/init?ytId=\" + this.streamId \n    )\n    .then(res => {\n      return res.json()\n    })\n    .then (res => {\n      //this.chatId = res.items[0].liveStreamingDetails.activeLiveChatId;\n      //this.channel = res.items[0].snippet.channelId;\n\n      this._updateChat();\n      this.updTimer = setInterval(this._updateChat.bind(this), 5000);\n    })\n    .catch (err => {\n      this._signal('onError', err);\n    })\n  }\n\n  disconnect () {\n\n    clearInterval(this.updTimer);\n    this._signal('onDisconnect', null);\n\n  }\n\n  updateViewers() {\n\n    /*return fetch(\n      `https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${this.streamId}&fields=items%2FliveStreamingDetails&key=${this.apikey}`\n      )\n      .then(res => res.json())\n      .then(res => {\n        if (res.items?.length > 0) {\n          this.viewersCount = res.items[0].liveStreamingDetails.concurrentViewers\n        }\n      })*/\n\n  }\n\n  _updateChat () {\n    fetch(\n      \"http://localhost:22137/pop?ytId=\" + this.streamId\n    )\n    .then (res => {\n      return res.json();\n    })\n    .then (res => {\n      res.items.forEach(msg => {\n       \n        /*\n         { channelId: i.authorExternalChannelId || i.authorName.simpleText, authorName: i.authorName.simpleText, msgContent: '$$SYS_MEMBER$$' }\n        */\n\n        // Check if this is a basic message\n        if (!msg.isSponsor) {\n\n          this._signal('onMessage', new TextMessage(\n            msg.channelId,\n            msg.authorName,\n            msg.msgContent,\n            'yt'\n          ));\n          return;\n        }\n\n        // Check if message have superchat data (like bits for Twitch)\n       /* if (msg.snippet.type == 'superChatEvent') {\n          this._signal('onSuperchat', new DonateMessage(\n            msg.snippet.authorChannelId,\n            msg.authorDetails.displayName,\n            msg.snippet.superChatDetails.tier > 5 ? 5 : msg.snippet.superChatDetails.tier,\n            1,\n            'yt'\n          ));\n\n          this._log(\"Get donate from \" + msg.authorDetails.displayName + \" - \" + msg.snippet.superChatDetails.amountMicros);\n          return;\n        }\n\n        else if (msg.snippet.type == 'superStickerEvent') {\n          this._signal('onSuperchat', new DonateMessage(\n            msg.snippet.authorChannelId,\n            msg.authorDetails.displayName,\n            msg.snippet.superStickerDetails.tier > 5 ? 5 : msg.snippet.superStickerDetails.tier,\n            1,\n            'yt'\n          ));\n\n          this._log(\"Get donate from \" + msg.authorDetails.displayName + \" - \" + msg.snippet.superChatDetails.amountMicros);\n          return;\n        }*/\n\n        // Check if this is new subscriber\n        if (msg.isSponsor) {\n          this._signal('onSub', new Subscriber(\n            msg.channelId,\n            msg.authorName,\n            'yt'\n          ));\n\n          this._log(\"New subscriber \" + msg.authorDetails.displayName);\n          return;\n        }\n      });\n    })\n  }\n\n  _log (msg) {\n    console.log('%cYoutube%c ' + msg, this.consoleStyle, '');\n  }\n\n  _signal (name, data) {\n\n    this.events[name](data);\n\n  }\n}","import {TextMessage, DonateMessage, Subscriber, Follower} from './streamEvents';\n\nexport default class TwitchConnect {\n\n  /**\n   * Create new chat object for Twitch\n   * @param {String} channel - Streamer nickname\n   */\n  constructor (channel) {\n    this.channel = channel;\n    this.userId = null;\n    this.viewersCount = 0;\n\n    this.apikey = \"vtr91vw1dzji7piypq7r13itr6is2i\"; // API Key for Twitch API. Not very secret information\n    this.botname = \"justinfan666\";\n    this.server = \"irc-ws.chat.twitch.tv\";\n\n    this.consoleStyle = 'background-color: #6441A4; color: #FFFFFF; border-radius: 100px;padding: 1px 4px;';\n\n    this.lastFollowers = [];\n    this.plannedDisconnect = false;\n\n    this.events = {\n      onMessage: () => {},\n      onSub: () => {},\n      onFollower: () => {},\n      onBits: () => {},\n\n      onConnect: () => {},\n      onDisconnect: () => {},\n      onError: () => {}\n    }\n  }\n\n  /**\n   * Connect to Twitch chat using websockets\n   */\n  connect () {\n    if (window.location.protocol.includes('https')) {\n      this.webSocket = new WebSocket('wss://' + this.server + ':443/', 'irc');\n    }\n    else {\n      this.webSocket = new WebSocket('ws://' + this.server + ':80/', 'irc');\n    }\n\n\n    this.webSocket.onmessage = this.onMessage.bind(this);\n    this.webSocket.onerror = this.onError.bind(this);\n    this.webSocket.onclose = this.onClose.bind(this);\n    this.webSocket.onopen = this.onOpen.bind(this);\n  }\n\n  /**\n   * Lauching request for checking new followers.\n   * Not working, because requires backend implementation\n   */\n  startCheckNewFollowers () {\n    this.checkFollowersFrom = Date.now();\n\n    let waitUserId = setInterval((() => {\n      if (this.userId) {\n        clearInterval(waitUserId);\n        this._checkFollowers();\n        this.updFollowersTimer = setInterval(this._checkFollowers.bind(this), 3*60*1000);\n      }\n    }).bind(this), 500);\n  }\n\n  /**\n   * Disable followers checking\n   */\n  stopCheckNewFollowers () {\n    clearInterval(this.updFollowersTimer);\n  }\n\n  updateViewers () {\n\n    return fetch(`https://api.twitch.tv/helix/streams?user_login=${this.channel}`, {\n      headers: { 'Client-ID': this.apikey },\n    })\n    .then(res => res.json())\n    .then(res => {\n      if (res.stream) {\n        this.viewersCount = res.stream.viewers\n      }\n    })\n\n  }\n\n  /**\n   * Calling whem new message received\n   * @param {String} msg - Raw message from Twitch\n   */\n  onMessage(msg) {\n    // Ignore incorrect messages\n    if (msg == null) return;\n\n    // Try to parse message\n    let parsed = this._parseMessage(msg.data);\n\n    //Ignore unparsed messages\n    if (parsed == null) return;\n\n    // Get PING, send PONG\n    if (parsed.command === \"PING\") {\n      this.webSocket.send(\"PONG :\" + parsed.message);\n      return;\n    }\n\n    // Get user id\n    if (parsed.command === \"ROOMSTATE\") {\n      this.userId = parsed.tags['room-id'];\n      return;\n    }\n\n    // Handle subscribers\n    if (parsed.command == \"USERNOTICE\" && (parsed.tags[\"msg-id\"].includes('sub') || parsed.tags[\"msg-id\"].includes('gift'))) {\n\n      // Gifted subs\n      if (parsed.tags.hasOwnProperty(\"msg-param-recipient-display-name\")) {\n        this._signal('onSub', new Subscriber(\n          parsed.tags[\"msg-param-recipient-id\"],\n          parsed.tags[\"msg-param-recipient-display-name\"],\n          'tw'\n        ));\n\n        this._log(\"New gifted subscriber \" + parsed.tags[\"msg-param-recipient-display-name\"]);\n      }\n\n      // Basic subs\n      else {\n        this._signal('onSub', new Subscriber(\n          parsed.tags[\"user-id\"],\n          parsed.tags[\"display-name\"],\n          'tw'\n        ));\n      }\n\n      this._log(\"New subscriber \" + parsed.tags[\"display-name\"]);\n    }\n\n    // Handle bits\n    else if (parsed.command == \"PRIVMSG\" && parsed.tags.hasOwnProperty('bits')) {\n\n      let bits = parseFloat(parsed.tags[\"bits\"]);\n      let bitsType = 1;\n      let bitsCount = bits > 10 ? 10 : bits;\n\n      if (bits < 10) return;\n\n      if (bits / 100 >= 1) {\n        bitsType = 2;\n        bitsCount = Math.round(bits / 100);\n      }\n\n      if (bits / 1000 >= 1) {\n        bitsType = 3;\n        bitsCount = Math.round(bits / 1000);\n      }\n\n      if (bits / 5000 >= 1) {\n        bitsType = 4;\n        bitsCount = Math.round(bits / 5000);\n      }\n\n      if (bits / 10000 >= 1) {\n        bitsType = 5;\n        bitsCount = Math.round(bits / 10000);\n      }\n\n      bitsCount = bitsCount > 10 ? 10 : bitsCount;\n\n      this._signal('onBits', new DonateMessage(\n        parsed.tags[\"user-id\"],\n        parsed.tags[\"display-name\"],\n        bitsCount,\n        bitsType,\n        'tw'\n      ));\n\n      this._log(\"Get donate from \" + parsed.tags[\"display-name\"] + \" - \" + parsed.tags[\"bits\"]);\n    }\n\n    // Handle default message\n    else if (parsed.command == \"PRIVMSG\") {\n      this._signal('onMessage', new TextMessage(\n        parsed.tags[\"user-id\"],\n        parsed.tags[\"display-name\"],\n        parsed.message,\n        'tw'\n      ));\n    }\n  }\n\n  /**\n   * Called on error with websocket\n   * @param {String} msg\n   */\n  onError (msg) {\n    this._signal('onError', msg);\n    this._log(\"Error: \");\n    console.log(msg);\n  }\n\n  /**\n   * Called on disconnect from websocket\n   */\n  onClose () {\n    if (this.plannedDisconnect) {\n      this._signal('onDisconnect');\n    }\n    else {\n      this.connect();\n    }\n\n    this._log(\"Disconnect from websocket\");\n  }\n\n  /**\n   * Called when connection with chat established\n   */\n  onOpen () {\n    if (this.webSocket !== null && this.webSocket.readyState === 1) {\n      this._log(\"Connected to websocket\");\n\n      this.webSocket.send('CAP REQ :twitch.tv/tags twitch.tv/commands twitch.tv/membership');\n      this.webSocket.send('NICK ' + this.botname);\n      this.webSocket.send('JOIN #' + this.channel.toLowerCase());\n\n      this._signal('onConnect');\n    }\n  }\n\n  /**\n   * Close current connection with Twitch chat\n   */\n  close () {\n    this.plannedDisconnect = true;\n    if(this.webSocket){\n      this.webSocket.close();\n    }\n  }\n\n  _signal (name, data) {\n    this.events[name](data);\n  }\n\n  _checkFollowers () {\n    fetch (\"https://api.twitch.tv/helix/users/follows?first=100&to_id=\" + this.userId, {\n      headers: {\n        'Client-ID': this.apikey\n      }\n    })\n    .then (res => res.json())\n    .then (res => {\n      res.data.forEach(follower => {\n        // If follower exists, skip it\n        if (this.lastFollowers.includes(follower.from_id)) return;\n\n        // Check array size and clear it if need\n        if (this.lastFollowers > 1000)\n          this.lastFollowers = this.lastFollowers.splice(100, 900);\n\n        // Add new follower to readed\n        this.lastFollowers.push(follower.from_id);\n\n        if (new Date(follower.followed_at) < this.checkFollowersFrom) return;\n\n        this._signal('onFollower', new Follower(\n          follower.from_id,\n          follower.from_name,\n          'tw'\n        ));\n\n        this._log(\"New follower \" + follower.from_name);\n      })\n    })\n  }\n\n  _log (msg) {\n    console.log('%cTwitch%c ' + msg, this.consoleStyle, '');\n  }\n\n  _parseMessage(rawMessage) {\n    let parsedMessage = {\n        message: null,\n        tags: null,\n        command: null,\n        original: rawMessage,\n        channel: null,\n        username: null\n    };\n\n    if(rawMessage[0] === '@') {\n        let tagIndex = rawMessage.indexOf(' '),\n        userIndex = rawMessage.indexOf(' ', tagIndex + 1),\n        commandIndex = rawMessage.indexOf(' ', userIndex + 1),\n        channelIndex = rawMessage.indexOf(' ', commandIndex + 1),\n        messageIndex = rawMessage.indexOf(':', channelIndex + 1);\n\n        // Parse tags to key-value dictionary\n        let tags = rawMessage.slice(0, tagIndex) != null ? rawMessage.slice(0, tagIndex).substr(1).split(\";\") : [];\n        let keyedTags = {};\n\n        tags.forEach(val => {\n          let splitted = val.split('=');\n          keyedTags[splitted[0]] = splitted[1];\n        });\n\n        parsedMessage.tags = keyedTags;\n\n        parsedMessage.username = rawMessage.slice(tagIndex + 2, rawMessage.indexOf('!'));\n        parsedMessage.command = rawMessage.slice(userIndex + 1, commandIndex);\n        parsedMessage.channel = rawMessage.slice(commandIndex + 1, channelIndex);\n        parsedMessage.message = rawMessage.slice(messageIndex + 1);\n    }\n    else if (rawMessage.startsWith(\"PING\")) {\n        parsedMessage.command = \"PING\";\n        parsedMessage.message = rawMessage.split(\":\")[1];\n    }\n\n    return parsedMessage;\n  }\n}"],"sourceRoot":""}